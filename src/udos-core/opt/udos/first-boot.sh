#!/bin/bash\n# uDESK first-boot wizard - complete setup\n\nFIRST_BOOT_FLAG=\"/etc/udos/first-boot-done\"\nLOG_FILE=\"/var/log/udos-firstboot.log\"\n\n# Skip if already completed\nif [ -f \"$FIRST_BOOT_FLAG\" ]; then\n    exit 0\nfi\n\necho \"$(date): Starting uDESK first-boot wizard\" | tee -a \"$LOG_FILE\"\n\n# ASCII welcome\ncat << 'EOF'\n â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n â”‚           Welcome to uDESK!             â”‚\n â”‚     Your Markdown Operating System      â”‚\n â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\nEOF\n\necho \"Setting up your markdown-focused environment...\"\n\n# Create directories\nmkdir -p /etc/udos/{services,templates,config}\nmkdir -p /opt/udos/{bin,lib,templates,logs,tmp}\nmkdir -p /home/tc/.udos/{vars,data,templates,logs,projects}\n\n# Set ownership\nchown -R tc:staff /home/tc/.udos 2>/dev/null || true\nchown -R root:root /etc/udos /opt/udos\n\n# Set default role\nif [ ! -f /etc/udos/role ]; then\n    echo \"basic\" > /etc/udos/role\nfi\n\n# Install markdown tools\necho \"Installing markdown tools...\"\nif ! command -v micro >/dev/null 2>&1; then\n    cd /tmp\n    curl -L https://github.com/zyedidia/micro/releases/latest/download/micro-2.0.11-linux64.tar.gz -o micro.tar.gz 2>/dev/null\n    tar -xzf micro.tar.gz 2>/dev/null\n    mv micro-2.0.11/micro /usr/local/bin/ 2>/dev/null\n    chmod +x /usr/local/bin/micro\n    rm -rf micro.tar.gz micro-2.0.11/\nfi\n\nif ! command -v glow >/dev/null 2>&1; then\n    cd /tmp\n    curl -L https://github.com/charmbracelet/glow/releases/latest/download/glow_1.5.1_linux_x86_64.tar.gz -o glow.tar.gz 2>/dev/null\n    tar -xzf glow.tar.gz 2>/dev/null\n    mv glow /usr/local/bin/ 2>/dev/null\n    chmod +x /usr/local/bin/glow\n    rm -rf glow.tar.gz\nfi\n\n# Configure tools\nmkdir -p /home/tc/.config/{micro,glow}\necho '{\"colorscheme\":\"monokai\",\"syntax\":true,\"softwrap\":true}' > /home/tc/.config/micro/settings.json\necho 'style: \"dark\"' > /home/tc/.config/glow/glow.yml\nchown -R tc:staff /home/tc/.config/ 2>/dev/null || true\n\n# Add aliases\ncat >> /home/tc/.profile << 'EOF'\n\n# uDESK Environment\nexport EDITOR=\"micro\"\nexport PAGER=\"glow\"\nalias md='micro'\nalias view='glow'\nalias info='udos-info'\nalias role='udos-detect-role'\nEOF\n\n# Create welcome document\ncat > /home/tc/udesk-welcome.md << 'EOF'\n# Welcome to uDESK!\n\nðŸŽ‰ Your markdown operating system is ready!\n\n## Quick Commands\n- `info` - System status\n- `md file.md` - Edit markdown\n- `view file.md` - View markdown\n- `role` - Check current role\n\n## Change Role\n```bash\necho \"admin\" > /etc/udos/role && exec bash\n```\n\n## Everything is Markdown\nAll configs, docs, and templates in uDESK are markdown.\n\n*Start exploring your new system!*\nEOF\n\nchown tc:staff /home/tc/udesk-welcome.md 2>/dev/null || true\n\n# Complete setup\ntouch \"$FIRST_BOOT_FLAG\"\necho \"$(date): uDESK first-boot completed\" | tee -a \"$LOG_FILE\"\necho \"âœ“ uDESK setup complete! Run: glow udesk-welcome.md\""}]