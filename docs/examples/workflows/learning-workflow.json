{
  "name": "Self-Learning Workflow Engine",
  "description": "Advanced workflow that learns from user patterns and adapts its behavior over time",
  "version": "1.0",
  "author": "uDOS M4 AI",
  "created": "2025-09-04",
  "enabled": true,
  "triggers": [
    {
      "type": "schedule",
      "cron": "0 */6 * * *",
      "description": "Run every 6 hours to learn patterns"
    },
    {
      "type": "command",
      "pattern": "learn workflow",
      "description": "Manual learning trigger"
    },
    {
      "type": "system",
      "event": "user_session_start",
      "description": "Learn when user starts working"
    }
  ],
  "conditions": [
    {
      "type": "data_available",
      "source": "command_history",
      "minimum_samples": 10,
      "description": "Need sufficient data to learn from"
    }
  ],
  "learning_actions": [
    {
      "type": "ai_suggest",
      "prompt": "Analyze recent command patterns and user behavior",
      "context": {
        "time_window": "last_24_hours",
        "command_frequency": "${COMMAND_FREQ}",
        "error_patterns": "${ERROR_PATTERNS}",
        "success_patterns": "${SUCCESS_PATTERNS}"
      }
    },
    {
      "type": "command",
      "command": "udos m4 ai stats",
      "timeout": 10000,
      "description": "Get current Smart learning statistics"
    },
    {
      "type": "variable",
      "key": "LEARNING_ITERATION",
      "value": "${CURRENT_ITERATION + 1}",
      "description": "Track learning iterations"
    },
    {
      "type": "ai_suggest",
      "prompt": "Based on usage patterns, what new workflows should be created?",
      "context": {
        "user_role": "${USER_ROLE}",
        "frequent_commands": "${FREQUENT_COMMANDS}",
        "time_patterns": "${TIME_PATTERNS}",
        "working_directories": "${COMMON_DIRS}"
      }
    }
  ],
  "adaptive_actions": [
    {
      "name": "schedule_optimization",
      "description": "Optimize workflow schedules based on user activity",
      "trigger_condition": "LEARNING_ITERATION % 5 == 0",
      "actions": [
        {
          "type": "ai_suggest",
          "prompt": "Suggest optimal schedule adjustments for workflows",
          "context": {
            "activity_patterns": "${USER_ACTIVITY}",
            "current_schedules": "${WORKFLOW_SCHEDULES}"
          }
        },
        {
          "type": "notification",
          "title": "Schedule Optimization",
          "message": "Smart suggests schedule adjustments: ${SCHEDULE_SUGGESTIONS}",
          "priority": "normal"
        }
      ]
    },
    {
      "name": "error_prevention",
      "description": "Create preventive workflows based on common errors",
      "trigger_condition": "ERROR_COUNT > 3",
      "actions": [
        {
          "type": "ai_suggest",
          "prompt": "Design preventive workflow for common error: ${COMMON_ERROR}",
          "context": {
            "error_frequency": "${ERROR_FREQ}",
            "error_context": "${ERROR_CONTEXT}",
            "prevention_strategies": "proactive"
          }
        },
        {
          "type": "file",
          "operation": "create",
          "path": "/tmp/udos-preventive-workflow-${DATE}.json",
          "content": "${PREVENTIVE_WORKFLOW_JSON}",
          "description": "Generate preventive workflow"
        }
      ]
    },
    {
      "name": "efficiency_improvements",
      "description": "Suggest workflow combinations and optimizations",
      "trigger_condition": "WORKFLOW_COUNT > 5",
      "actions": [
        {
          "type": "ai_suggest",
          "prompt": "Identify workflow consolidation opportunities",
          "context": {
            "existing_workflows": "${WORKFLOW_LIST}",
            "execution_frequency": "${EXEC_FREQ}",
            "overlap_analysis": "automatic"
          }
        }
      ]
    }
  ],
  "knowledge_base_actions": [
    {
      "type": "file",
      "operation": "create",
      "path": "/tmp/udos-learning-report-${DATE}.md",
      "content": "# uDOS M4 Learning Report - ${DATE}\n\n## Pattern Analysis\n- Command frequency: ${COMMAND_ANALYSIS}\n- Time patterns: ${TIME_ANALYSIS}\n- Error patterns: ${ERROR_ANALYSIS}\n\n## Recommendations\n${AI_RECOMMENDATIONS}\n\n## Suggested Workflows\n${WORKFLOW_SUGGESTIONS}\n\n## Next Learning Cycle\n${NEXT_LEARNING_FOCUS}",
      "description": "Generate comprehensive learning report"
    },
    {
      "type": "variable",
      "key": "LAST_LEARNING_REPORT",
      "value": "/tmp/udos-learning-report-${DATE}.md",
      "description": "Track latest learning report"
    },
    {
      "type": "notification",
      "title": "Learning Cycle Complete",
      "message": "Smart completed learning iteration ${LEARNING_ITERATION}. Report: ${LAST_LEARNING_REPORT}",
      "priority": "normal"
    }
  ],
  "meta_learning": {
    "improvement_tracking": [
      {
        "metric": "workflow_effectiveness",
        "baseline": "${BASELINE_EFFECTIVENESS}",
        "current": "${CURRENT_EFFECTIVENESS}",
        "target_improvement": "10%"
      },
      {
        "metric": "user_productivity",
        "measurement": "commands_per_session",
        "trend_analysis": true
      },
      {
        "metric": "error_reduction",
        "measurement": "error_rate_decrease",
        "target": "reduce by 20%"
      }
    ],
    "learning_goals": [
      "Reduce repetitive manual tasks",
      "Predict user needs proactively",
      "Optimize system performance",
      "Improve error prevention"
    ]
  },
  "variables": {
    "LEARNING_WINDOW": "7_days",
    "MIN_PATTERN_CONFIDENCE": "0.7",
    "MAX_SUGGESTIONS_PER_CYCLE": "5",
    "ADAPTATION_THRESHOLD": "0.8"
  },
  "metadata": {
    "category": "ai_learning",
    "tags": ["machine-learning", "adaptive", "self-improving", "analytics"],
    "complexity": "expert",
    "estimated_runtime": "5-10 minutes",
    "learning_capability": "advanced"
  }
}
