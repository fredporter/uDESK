{
  "name": "System Health Monitor",
  "description": "Comprehensive system health check with Smart-powered analysis and recommendations",
  "version": "1.0", 
  "author": "uDOS M4 AI",
  "created": "2025-09-04",
  "enabled": true,
  "triggers": [
    {
      "type": "schedule",
      "cron": "*/30 * * * *",
      "description": "Check every 30 minutes"
    },
    {
      "type": "command",
      "pattern": "health check",
      "description": "Manual health check trigger"
    },
    {
      "type": "system",
      "event": "high_cpu_usage",
      "threshold": "80%",
      "description": "Trigger on high CPU usage"
    }
  ],
  "conditions": [
    {
      "type": "system_load",
      "maximum": "5.0",
      "description": "Don't run during high system load"
    }
  ],
  "actions": [
    {
      "type": "command",
      "command": "udos info",
      "timeout": 10000,
      "description": "Get comprehensive system information"
    },
    {
      "type": "command",
      "command": "udos test quick",
      "timeout": 15000,
      "description": "Run quick system test"
    },
    {
      "type": "variable",
      "key": "HEALTH_CHECK_TIME",
      "value": "${TIMESTAMP}",
      "description": "Record health check timestamp"
    },
    {
      "type": "ai_suggest",
      "prompt": "Based on system status, what maintenance should be performed?",
      "context": {
        "system_info": "${SYSTEM_INFO}",
        "test_results": "${TEST_RESULTS}",
        "cpu_usage": "${CPU_USAGE}",
        "memory_usage": "${MEMORY_USAGE}",
        "disk_usage": "${DISK_USAGE}"
      }
    },
    {
      "type": "file",
      "operation": "create", 
      "path": "/tmp/udos-health-${DATE}-${HOUR}.json",
      "content": "{\n  \"timestamp\": \"${TIMESTAMP}\",\n  \"status\": \"${SYSTEM_STATUS}\",\n  \"cpu\": \"${CPU_USAGE}\",\n  \"memory\": \"${MEMORY_USAGE}\",\n  \"disk\": \"${DISK_USAGE}\",\n  \"recommendations\": \"${AI_SUGGESTIONS}\"\n}",
      "description": "Log health check results"
    }
  ],
  "conditional_actions": [
    {
      "condition": "CPU_USAGE > 90",
      "actions": [
        {
          "type": "notification",
          "title": "High CPU Alert",
          "message": "CPU usage is ${CPU_USAGE}% - investigating processes",
          "priority": "urgent"
        },
        {
          "type": "command",
          "command": "ps aux --sort=-%cpu | head -10",
          "description": "List top CPU consuming processes"
        }
      ]
    },
    {
      "condition": "MEMORY_USAGE > 85",
      "actions": [
        {
          "type": "notification",
          "title": "Memory Warning",
          "message": "Memory usage is ${MEMORY_USAGE}% - check for memory leaks",
          "priority": "high"
        },
        {
          "type": "ai_suggest",
          "prompt": "High memory usage detected, suggest optimization strategies"
        }
      ]
    },
    {
      "condition": "DISK_USAGE > 80",
      "actions": [
        {
          "type": "notification",
          "title": "Disk Space Warning", 
          "message": "Disk usage is ${DISK_USAGE}% - cleanup recommended",
          "priority": "high"
        },
        {
          "type": "command",
          "command": "udos system cleanup",
          "description": "Automated cleanup of temporary files"
        }
      ]
    }
  ],
  "variables": {
    "CPU_THRESHOLD": "80",
    "MEMORY_THRESHOLD": "85", 
    "DISK_THRESHOLD": "80",
    "ALERT_EMAIL": "sysadmin@example.com"
  },
  "metadata": {
    "category": "monitoring",
    "tags": ["health", "monitoring", "proactive", "ai-assisted"],
    "complexity": "advanced",
    "estimated_runtime": "1-3 minutes"
  }
}
